<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Apresentação Power BI</title>
  <script>
    // IDs fixos
    const reportId = "26027287-2b05-41b5-9a7d-493fe00c80bf";
    const tenantId = "7e4058f3-1c1f-4c3a-8151-03d3a2c3c30c";

    // Páginas personalizadas
    const pageNames = ["Televisão"];
    
    // Salvar o índice atual da página em localStorage (para manter entre reloads)
    let currentPage = parseInt(localStorage.getItem("currentPage") || "0");

    // Atualiza a página (reload total)
    function redirectToNextPage() {
      const nextPage = pageNames[currentPage];
      const nextUrl = `${window.location.origin}${window.location.pathname}?page=${nextPage}`;

      // Atualiza o índice para próxima execução
      currentPage = (currentPage + 1) % pageNames.length;
      localStorage.setItem("currentPage", currentPage);

      window.location.href = nextUrl;
    }

    // Aguarda 5 segundos e recarrega para a próxima página
    setTimeout(redirectToNextPage, 5000);
  </script>
</head>
<body style="margin:0;padding:0;overflow:hidden">
  <iframe
    id="pbiFrame"
    width="100%"
    height="100%"
    frameborder="0"
    allowFullScreen="true"
    src=""
  ></iframe>

  <script>
    // Pega o parâmetro ?page= da URL
    const urlParams = new URLSearchParams(window.location.search);
    const currentPageName = urlParams.get("page") || "Televisão";

    const iframeUrl = `https://app.powerbi.com/reportEmbed?reportId=${reportId}&autoAuth=true&ctid=${tenantId}&pageName=${currentPageName}`;
    document.getElementById("pbiFrame").src = iframeUrl;
  </script>
</body>
</html>
